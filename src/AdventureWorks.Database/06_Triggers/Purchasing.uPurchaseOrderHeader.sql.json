{
  "triggerName": "uPurchaseOrderHeader",
  "schemaName": "Purchasing",
  "definition": "\r\nCREATE TRIGGER [Purchasing].[uPurchaseOrderHeader] ON [Purchasing].[PurchaseOrderHeader] \r\nAFTER UPDATE AS \r\nBEGIN\r\n    DECLARE @Count int;\r\n\r\n    SET @Count = @@ROWCOUNT;\r\n    IF @Count = 0 \r\n        RETURN;\r\n\r\n    SET NOCOUNT ON;\r\n\r\n    BEGIN TRY\r\n        -- Update RevisionNumber for modification of any field EXCEPT the Status.\r\n        IF NOT UPDATE([Status])\r\n        BEGIN\r\n            UPDATE [Purchasing].[PurchaseOrderHeader]\r\n            SET [Purchasing].[PurchaseOrderHeader].[RevisionNumber] = \r\n                [Purchasing].[PurchaseOrderHeader].[RevisionNumber] + 1\r\n            WHERE [Purchasing].[PurchaseOrderHeader].[PurchaseOrderID] IN \r\n                (SELECT inserted.[PurchaseOrderID] FROM inserted);\r\n        END;\r\n    END TRY\r\n    BEGIN CATCH\r\n        EXECUTE [dbo].[uspPrintError];\r\n\r\n        -- Rollback any active or uncommittable transactions before\r\n        -- inserting information in the ErrorLog\r\n        IF @@TRANCOUNT > 0\r\n        BEGIN\r\n            ROLLBACK TRANSACTION;\r\n        END\r\n\r\n        EXECUTE [dbo].[uspLogError];\r\n    END CATCH;\r\nEND;\r\n",
  "tableName": "PurchaseOrderHeader"
}